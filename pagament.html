<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pagamento - Micro SaaS</title>
  <style>
     :root{
        --bg:#0b1220;
        --panel:#0f1724;
        --muted:#94a3b8;
        --accent:#06b6d4;
        --accent-2:#0891b2;
        --glass: rgba(255,255,255,0.04);
      }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background:linear-gradient(180deg,#07101a 0%, #0b1220 100%);
      color: #f5f5f5;
      margin: 0;
      padding: 40px 0;
      display: flex;
      justify-content: center;
     
    }
    .container {
      background:linear-gradient(180deg,var(--panel), rgba(14,20,28,0.9));
      padding: 30px;
      margin:0px auto;
      border-radius: 15px;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      font-size: 13px;
    }
    h1 {
      font-size: 22px;
      margin-bottom: 20px;
      color:var(--accent)
    }
    .expresse-box {
      
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 15px;
      font-size: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .expresse-box button {
      background: #4cafef;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      color: #fff;
      cursor: pointer;
      transition: background 0.3s;
    }
    .expresse-box button:hover {
      background: #379fd1;
    }
    input[type="file"] 
      {
    background:var(--accent);color:#022; border:0;padding:11px 14px;border-radius:10px;font-weight:700;cursor:pointer,
    }
    
   
    .message {
      margin-top: 15px;
      font-size: 14px;
    }
    .error { color: #ff5252; }
    .success { color: #4caf50; }
     .copy-box{display:flex;align-items:center;justify-content:space-between;background:var(--glass);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);font-weight:700}
      .copy-num{font-size:16px;letter-spacing:0.6px}
      .btn{background:var(--accent);color:#022; border:0;padding:11px 14px;border-radius:10px;font-weight:700;cursor:pointer}
      .btn:hover{background:var(--accent-2)}
      .status{padding:12px;border-radius:10px;background:rgba(6,182,212,0.08);color:var(--accent);font-weight:700;margin-top:12px}
      .meta{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
      .pill{background:rgba(255,255,255,0.02);padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.02);font-weight:600}
      .small{font-size:13px;color:var(--muted)}
      .card{background:linear-gradient(180deg,var(--panel), rgba(14,20,28,0.9)); border-radius:14px; padding:22px; box-shadow:0 10px 30px rgba(2,6,23,0.6); border:1px solid rgba(255,255,255,0.03)}
      .comprovativo{
        color:#022;

    }
      .beco{
        text-align: center;
        align-items: center;

    }
      .file{
        background:var(--accent);color:#022; border:0;padding:11px 14px;border-radius:10px;font-weight:700;cursor:pointer}
      .file:hover{background:var(--accent-2)}
    
.mensagem-box {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  padding: 20px 30px;
  border-radius: 10px;
  font-size: 16px;
  font-weight: bold;
  display: none;
  z-index: 9999;
  text-align: center;
  max-width: 80%;
}

/* Cores */
.mensagem-box.sucesso {
  background: #2ecc71;
  color: #fff;
}
.mensagem-box.erro {
  background: #e74c3c;
  color: #fff;
}
.mensagem-box.info {
  background: #3498db;
  color: #fff;
}


      
      .toast {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%) translateY(20px);
  background: linear-gradient(135deg, var(--accent), var(--accent-2));
  color: #fff;
  padding: 14px 24px;
  border-radius: 12px;
  font-weight: 600;
  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
  opacity: 0;
  transition: opacity 0.3s ease, transform 0.3s ease;
  z-index: 1000;
}

.toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}
 /* Responsivo */
    @media (max-width: 480px) {
      .container {
        margin: 20px;
        padding: 20px;
        width: 300px;
      }
      .card {
        width: 250px;
      }
      h1 {
        font-size: 18px;
      }
      .copy-num {
        font-size: 14px;
      }
      .btn {
        font-size: 14px;
        padding: 9px 12px;
      }
      input[type="file"] { 
    width: 230px;
    }
    }
  </style>
</head>
<body>
  <div class="container">
            <h1>Pagamento via Multicaixa Expresse</h1>

            <p>Realize a transferência no Multicaixa Expresse para o número abaixo. Depois, envie o comprovativo em PDF para validação automática. </p>
        <div class="meta">
                
                <div class="pill small">Valor: <strong id="amount">5.000 AOA</strong></div>
                
                <div style="margin-top:14px" class="field">
            
                <label style="display:block;margin-bottom:8px;font-weight:700;color:var(--accent)">Número Expresse</label>
                <div class="copy-box">
            <div class="copy-num" id="expresse-number">943799795</div>
            <button class="btn" onclick="copyNumber()">Copiar</button>
            </div>

        


            <div style="margin-top:18px" class="card">
                <h2 class="comprovativo" style="margin:0 0 6px;font-size:18px;color:var(--accent)">Enviar comprovativo</h2>
                <p class="small">Depois de finalizar a transferência no Multicaixa Expresse, faça o upload do comprovativo aqui. O sistema fará validação automática.</p>
                <div class="beco">
            <form id="uploadForm" >
            <input type="file" id="comprovativo" accept="application/pdf" class="file" required>
                    <div style="margin-top:12px;display:flex;gap:10px;align-items:center" class="beco">
                    <button class="btn" type="submit" >Enviar Comprovativo</button><div class="small" style="color:var(--muted)">Formatos: PDF.</div>
                
            </form></div>
        
            <div id="message" class="message"></div>
            <div id="mensagemBox" class="mensagem-box"></div>
            <div id="statusBox" class="status">Aguardando envio do comprovativo.</div>
        </div>
</div>
  <script>
    function showToast(msg) {
  const toast = document.createElement("div");
  toast.className = "toast";
  toast.innerText = msg;
  document.body.appendChild(toast);

  setTimeout(() => toast.classList.add("show"), 100);

  setTimeout(() => {
    toast.classList.remove("show");
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

function copyNumber() {
  const number = document.getElementById("expresse-number").innerText;
  navigator.clipboard.writeText(number).then(() => {
    showToast("Número copiado com sucesso!");
  });
}


    document.getElementById("uploadForm").addEventListener("submit", async function (e) {
  e.preventDefault();

  const fileInput = document.getElementById("comprovativo");
  if (fileInput.files.length === 0) {
    mostrarMensagem("⚠️ Selecione um arquivo PDF antes de enviar.", "erro");
    return;
  }

  const formData = new FormData();
  formData.append("file", fileInput.files[0]);

  mostrarMensagem("⏳ Validando comprovativo, aguarde...", "info");

  try {
    const resposta = await fetch("/api/verificarComprovativo", {
      method: "POST",
      body: formData,
    });

    const dados = await resposta.json();

    if (dados.sucesso) {
      mostrarMensagem("✅ Pagamento validado com sucesso!", "sucesso");

      // Redirecionar após 2 segundos
      setTimeout(() => {
        window.location.href = "editor.html?modelo=1"; // ajuste a URL de destino
      }, 2000);
    } else {
      mostrarMensagem("❌ " + dados.mensagem, "erro");
    }
  } catch (error) {
    console.error(error);
    mostrarMensagem("⚠️ Erro ao enviar comprovativo. Tente novamente.", "erro");
  }
});

// Função para exibir mensagens no centro da tela
function mostrarMensagem(texto, tipo) {
  const mensagemBox = document.getElementById("mensagemBox");
  mensagemBox.innerText = texto;

  mensagemBox.className = "mensagem-box"; // reset classes
  if (tipo === "sucesso") mensagemBox.classList.add("sucesso");
  if (tipo === "erro") mensagemBox.classList.add("erro");
  if (tipo === "info") mensagemBox.classList.add("info");

  mensagemBox.style.display = "block";
}
  </script>
</body>
</html>
