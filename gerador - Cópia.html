<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gerador de Logotipos — Demo</title>

  <!-- Fontes (opcional) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary:#1E40AF;
      --accent:#FACC15;
      --bg:#F3F4F6;
      --text:#111827;
    }
    *{box-sizing:border-box}
    body{
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--bg);
      color:var(--text);
      margin:0;
      padding:0;
    }
    header{
      background:linear-gradient(90deg,var(--primary), #0247b3);
      color:white;
      padding:18px 20px;
      text-align:center;
    }
    header h1{font-family:Poppins, Inter; font-size:20px; margin:0}
    .wrap{max-width:1100px; margin:24px auto; padding:18px;}
    .grid{display:grid; grid-template-columns: 1fr 460px; gap:20px;}
    .card{background:#fff; padding:18px; border-radius:12px; box-shadow:0 6px 18px rgba(16,24,40,0.06);}
    label{display:block; font-size:0.9rem; margin-bottom:6px; color:#444}
    .form-row{margin-bottom:12px}
    input[type="text"], select, input[type="color"]{
      width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e6e9ee; font-size:1rem;
    }
    .actions{display:flex; gap:10px; margin-top:8px}
    .btn{
      display:inline-block; padding:10px 14px; border-radius:10px; border:0; cursor:pointer; font-weight:600;
    }
    .btn.primary{background:var(--primary); color:#fff}
    .btn.ghost{background:transparent; border:1px solid #ddd; color:#333}
    /* preview area */
    .preview-area{display:flex; flex-direction:column; align-items:center; gap:12px}
    .preview-box{width:380px; height:380px; border-radius:14px; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,#fff,#fbfdff); border:1px solid #e6eefb}
    .small{font-size:0.85rem; color:#666}
    footer{margin-top:18px; text-align:center; color:#666; font-size:0.9rem}
    @media (max-width:980px){
      .grid{grid-template-columns:1fr; padding-bottom:40px}
      .preview-box{width:320px;height:320px}
    }
  </style>
</head>
<body>
  <header>
    <h1>Gerador Automático de Logotipos (templates)</h1>
  </header>

  <div class="wrap">
    <div class="grid">
      <!-- Editor -->
      <div class="card">
        <h2 style="margin-top:0">Personalize o seu logo</h2>

        <div class="form-row">
          <label for="brand">Nome da marca</label>
          <input id="brand" type="text" placeholder="Ex: Padaria Bom Pão" value="Minha Marca">
        </div>

        <div class="form-row">
          <label for="slogan">Slogan (opcional)</label>
          <input id="slogan" type="text" placeholder="Ex: Pão fresco todos os dias" value="">
        </div>

        <div class="form-row">
          <label for="color">Cor principal</label>
          <input id="color" type="color" value="#1E40AF">
        </div>

        <div class="form-row">
          <label for="font">Fonte</label>
          <select id="font">
            <option value="Poppins, system-ui, Arial">Poppins</option>
            <option value="Inter, system-ui, Arial">Inter</option>
            <option value="Georgia, serif">Georgia</option>
            <option value="Arial, Helvetica, sans-serif">Arial</option>
          </select>
        </div>

        <div class="form-row">
          <label for="icon">Ícone (template)</label>
          <select id="icon">
            <option value="circle">Marca (círculo)</option>
            <option value="leaf">Folha</option>
            <option value="shop">Loja</option>
            <option value="star">Estrela</option>
            <option value="bolt">Raio</option>
            <option value="spark">Brilho</option>
          </select>
        </div>

        <div class="form-row">
          <label for="layout">Layout</label>
          <select id="layout">
            <option value="left">Ícone à esquerda</option>
            <option value="stack">Ícone acima (stack)</option>
            <option value="badge">Badge (ícone dentro de círculo)</option>
          </select>
        </div>

        <div class="form-row">
          <label for="size">Tamanho de exportação (px)</label>
          <select id="size">
            <option value="800">800 × 800</option>
            <option value="1200" selected>1200 × 1200</option>
            <option value="2000">2000 × 2000</option>
          </select>
        </div>

        <div class="actions">
          <button id="updateBtn" class="btn primary">Atualizar Pré-visualização</button>
          <button id="downloadBtn" class="btn ghost">Baixar PNG</button>
        </div>

        <p class="small" style="margin-top:10px">
          Este gerador usa templates SVG — exporta imagens limpas (PNG) prontas para uso.
        </p>
      </div>

      <!-- Preview -->
      <div class="card preview-area">
        <h3 style="margin:0">Pré-visualização</h3>
        <div id="preview" class="preview-box" aria-hidden="false">
          <!-- SVG será injetado aqui -->
        </div>
        <div class="small">Clique em <strong>Baixar PNG</strong> para exportar o logo em alta resolução.</div>
      </div>
    </div>

    <footer>Teste no seu navegador — se algo não aparecer, verifique o Console (F12).</footer>
  </div>

  <script>
  // ===== util =====
  function esc(txt){
    if (!txt && txt !== '') return '';
    return String(txt).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
  }

  // desenha ícones SVG (retornam fragmentos)
  function drawIconSVG(name, size, fill) {
    const s = size;
    if (name === 'circle') {
      return `<circle cx="${s/2}" cy="${s/2}" r="${s/2 - 6}" fill="${fill}" />`;
    }
    if (name === 'leaf') {
      return `<path d="M ${s*0.15} ${s*0.6} C ${s*0.35} ${s*0.05}, ${s*0.85} ${s*0.05}, ${s*0.85} ${s*0.6} C ${s*0.5} ${s*0.6}, ${s*0.4} ${s*0.9}, ${s*0.15} ${s*0.6}" fill="${fill}" />`;
    }
    if (name === 'shop') {
      return `<rect x="${s*0.12}" y="${s*0.22}" width="${s*0.76}" height="${s*0.56}" rx="${s*0.06}" fill="${fill}" /><rect x="${s*0.26}" y="${s*0.35}" width="${s*0.48}" height="${s*0.28}" fill="#fff" />`;
    }
    if (name === 'star') {
      return `<polygon points="${s*0.5},${s*0.08} ${s*0.62},${s*0.38} ${s*0.95},${s*0.38} ${s*0.69},${s*0.58} ${s*0.81},${s*0.9} ${s*0.5},${s*0.7} ${s*0.19},${s*0.9} ${s*0.31},${s*0.58} ${s*0.05},${s*0.38} ${s*0.38},${s*0.38}" fill="${fill}" />`;
    }
    if (name === 'bolt') {
      return `<path d="M ${s*0.36} ${s*0.1} L ${s*0.72} ${s*0.1} L ${s*0.44} ${s*0.6} L ${s*0.8} ${s*0.6} L ${s*0.24} ${s*0.98} L ${s*0.36} ${s*0.58} L ${s*0.04} ${s*0.58} Z" transform="scale(${s},${s})" fill="${fill}" />`.replace(/,/, '');
    }
    if (name === 'spark') {
      return `<g fill="${fill}"><rect x="${s*0.46}" y="${s*0.08}" width="${s*0.08}" height="${s*0.28}" rx="${s*0.02}"/><rect x="${s*0.46}" y="${s*0.64}" width="${s*0.08}" height="${s*0.28}" rx="${s*0.02}"/><rect x="${s*0.08}" y="${s*0.46}" width="${s*0.28}" height="${s*0.08}" rx="${s*0.02}"/><rect x="${s*0.64}" y="${s*0.46}" width="${s*0.28}" height="${s*0.08}" rx="${s*0.02}"/><circle cx="${s*0.5}" cy="${s*0.5}" r="${s*0.08}"/></g>`;
    }
    // fallback: circle
    return `<circle cx="${s/2}" cy="${s/2}" r="${s/2 - 6}" fill="${fill}" />`;
  }

  // gera string SVG completa
  function buildSVG({brand, slogan, color, fontFamily, icon, layout, canvasSize}) {
    const W = canvasSize;
    const H = canvasSize;
    const padding = Math.round(W * 0.06);
    const iconSize = Math.round(W * 0.28); // icon dimension
    const textColor = color; // same color for text accent
    const brandEsc = esc(brand || '');
    const sloganEsc = esc(slogan || '');
    // choose font fallback chain already provided via fontFamily string
    // build inner shapes depending on layout
    let inner = '';
    if (layout === 'left') {
      const iconX = padding;
      const iconY = Math.round((H - iconSize) / 2);
      const textX = iconX + iconSize + Math.round(W*0.04);
      // icon group at left
      inner += `<g transform="translate(${iconX}, ${iconY})" aria-label="icon">${drawIconSVG(icon, iconSize, color)}</g>`;
      // text group
      inner += `<g transform="translate(${textX}, ${Math.round(H/2) - 12})">`;
      inner += `<text x="0" y="-6" font-family="${fontFamily}" font-weight="700" font-size="${Math.round(W*0.08)}" fill="${textColor}">${brandEsc}</text>`;
      if (sloganEsc) inner += `<text x="0" y="${Math.round(W*0.06)}" font-family="${fontFamily}" font-weight="400" font-size="${Math.round(W*0.037)}" fill="#384047">${sloganEsc}</text>`;
      inner += `</g>`;
    } else if (layout === 'stack') {
      const iconX = Math.round((W - iconSize) / 2);
      const iconY = padding;
      inner += `<g transform="translate(${iconX}, ${iconY})">${drawIconSVG(icon, iconSize, color)}</g>`;
      const textY = iconY + iconSize + Math.round(W*0.03);
      inner += `<g transform="translate(${Math.round(W/2)}, ${textY})">`;
      inner += `<text x="0" y="0" font-family="${fontFamily}" font-weight="700" font-size="${Math.round(W*0.1)}" fill="${textColor}" text-anchor="middle">${brandEsc}</text>`;
      if (sloganEsc) inner += `<text x="0" y="${Math.round(W*0.06)}" font-family="${fontFamily}" font-weight="400" font-size="${Math.round(W*0.04)}" fill="#384047" text-anchor="middle">${sloganEsc}</text>`;
      inner += `</g>`;
    } else { // badge
      const center = Math.round(W/2);
      const iconY = Math.round(H*0.26);
      const badgeRadius = Math.round(iconSize*0.9);
      inner += `<g transform="translate(${center - badgeRadius/2}, ${iconY - badgeRadius/2})">`;
      inner += `<circle cx="${badgeRadius/2}" cy="${badgeRadius/2}" r="${badgeRadius/2}" fill="${color}" />`;
      inner += `<g transform="translate(${badgeRadius*0.18}, ${badgeRadius*0.18})" >${drawIconSVG(icon, Math.round(badgeRadius*0.64), '#fff')}</g>`;
      inner += `</g>`;
      const textY = iconY + badgeRadius/2 + Math.round(W*0.06);
      inner += `<g transform="translate(${center}, ${textY})">`;
      inner += `<text x="0" y="0" font-family="${fontFamily}" font-weight="700" font-size="${Math.round(W*0.085)}" fill="${textColor}" text-anchor="middle">${brandEsc}</text>`;
      if (sloganEsc) inner += `<text x="0" y="${Math.round(W*0.06)}" font-family="${fontFamily}" font-weight="400" font-size="${Math.round(W*0.035)}" fill="#384047" text-anchor="middle">${sloganEsc}</text>`;
      inner += `</g>`;
    }

    // full SVG
    const svg = `
      <svg xmlns="http://www.w3.org/2000/svg" width="${W}" height="${H}" viewBox="0 0 ${W} ${H}">
        <rect width="100%" height="100%" fill="#ffffff"/>
        <style>
          text { dominant-baseline: hanging; }
        </style>
        ${inner}
      </svg>
    `;
    return svg;
  }

  // converte svg string -> PNG dataURL
  function svgToPngDataUrl(svgString, width, height, callback){
    try {
      const blob = new Blob([svgString], {type: 'image/svg+xml;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const img = new Image();
      img.onload = () => {
        try {
          const canvas = document.createElement('canvas');
          canvas.width = width;
          canvas.height = height;
          const ctx = canvas.getContext('2d');
          // clear and draw
          ctx.clearRect(0,0,canvas.width,canvas.height);
          ctx.drawImage(img, 0, 0, width, height);
          URL.revokeObjectURL(url);
          const dataUrl = canvas.toDataURL('image/png');
          callback(null, dataUrl);
        } catch (err){
          callback(err);
        }
      };
      img.onerror = (e) => {
        callback(new Error('Falha ao carregar SVG na imagem.'));
      };
      img.src = url;
    } catch (err){
      callback(err);
    }
  }

  // atualiza preview (injeta SVG e ajusta box)
  function updatePreviewImmediate(){
    const brand = document.getElementById('brand').value.trim();
    const slogan = document.getElementById('slogan').value.trim();
    const color = document.getElementById('color').value;
    const font = document.getElementById('font').value;
    const icon = document.getElementById('icon').value;
    const layout = document.getElementById('layout').value;
    const size = parseInt(document.getElementById('size').value, 10) || 1200;

    const svg = buildSVG({brand, slogan, color, fontFamily: font, icon, layout, canvasSize: 600}); // preview smaller
    const preview = document.getElementById('preview');
    preview.innerHTML = svg;
  }

  // download PNG (uses selected export size)
  function downloadPNG(){
    const brand = document.getElementById('brand').value.trim();
    const slogan = document.getElementById('slogan').value.trim();
    const color = document.getElementById('color').value;
    const font = document.getElementById('font').value;
    const icon = document.getElementById('icon').value;
    const layout = document.getElementById('layout').value;
    const size = parseInt(document.getElementById('size').value, 10) || 1200;

    const svg = buildSVG({brand, slogan, color, fontFamily: font, icon, layout, canvasSize: size});
    // ensure fonts loaded (best-effort)
    const waitFonts = (document.fonts && document.fonts.ready) ? document.fonts.ready : Promise.resolve();
    waitFonts.then(() => {
      svgToPngDataUrl(svg, size, size, (err, dataUrl) => {
        if (err) {
          console.error('Erro na conversão SVG->PNG:', err);
          alert('Ocorreu um erro ao gerar a imagem. Veja o console para detalhes.');
          return;
        }
        const a = document.createElement('a');
        const filename = (brand || 'logo').replace(/\s+/g, '_').toLowerCase() + '.png';
        a.href = dataUrl;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        a.remove();
      });
    }).catch(() => {
      // mesmo sem fonts ready, tenta converter
      svgToPngDataUrl(svg, size, size, (err, dataUrl) => {
        if (err) { alert('Erro ao gerar imagem — veja console'); console.error(err); return; }
        const a = document.createElement('a'); a.href = dataUrl; a.download = 'logo.png'; a.click();
      });
    });
  }

  // eventos e inicialização
  document.getElementById('updateBtn').addEventListener('click', updatePreviewImmediate);
  document.getElementById('downloadBtn').addEventListener('click', downloadPNG);

  // atualiza em tempo real ao editar
  ['brand','slogan','color','font','icon','layout','size'].forEach(id => {
    document.getElementById(id).addEventListener('input', updatePreviewImmediate);
  });

  // inicial preview
  updatePreviewImmediate();
  </script>
</body>
</html>
