<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Editor de Currículo</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    
* {
      box-sizing: border-box;
    }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(145deg, #0c0c0c, #011427);
      margin: 0;
      padding: 20px;
    }

    header{
      background-color: #1e3a8a;
      color: white;
      padding: 1rem;
      font-weight: 620;
      text-align: center;
      font-size: 1.5rem;
      border-radius: 10px;
      align-items: center;
    }

    .wrapper {
     display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: center;
      align-items: flex-start;
      padding: 1rem;
      gap: 2rem;
    }

    .editor-panel {
     flex: 1 1 300px;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 20px #02ad0b;
      max-width: 400px;
    }

    .editor-panel h2 {
      margin-bottom: 16px;
      font-size: 20px;
    }

    .editor-panel label {
      display: block;
      margin-top: 12px;
      font-weight: 500;
    }



    .editor-panel input,
    .editor-panel textarea {
      width: 100%;
      padding: 8px;
      margin-top: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .curriculo-container {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
}

    .acoes {
      margin-top: 1rem;
      text-align: center;
    }

    .acoes button {
      margin: 0.5rem;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      background-color: #393cff;
      color: white;
      cursor: pointer;
      font-weight: 600;
      font-size: 1rem;
    }
    .acoes button:hover{
      background-color: #4caf50;
    }

    .acoess {
      margin-top: 20px;
      text-align: center;
    }

    .acoess button {
      margin: 5px;
      border: none;
      color: white;
      cursor: pointer;
      background: #393cff;
      padding: 16px;
      text-align: center;
      font-size: 24px;
      font-weight: 620;
      border-radius: 8px;
      margin-bottom: 20px;
    }
.botoes {
      text-align: center;
      margin-top: 1rem;
      align-items: center;
      
    }

    button {
      margin: 0.5rem;
      padding: 10px 20px;
      font-size: 1rem;
      background-color: #1e3a8a;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
    }

    button:hover {
      background-color: #374bb3;
    }
     .cee{     
      color: #0f172a;
      font-size: 1.6rem;
      border-bottom: 2px solid #3b82f6;
      padding-bottom: 0.3rem;
      margin-bottom: 1.5rem;
    }

    @media (max-width: 798px) {
      

      .editor-panel {
        width: 370px;
      }

       .curriculo-container.a4 {
    transform: scale(0.5);
    transform-origin: top center;
      align-items: center;
  }
h2.cee{     
      font-size: 1.1rem;
      ;
    }

    }

    @media (max-width: 420px) {
      
.cee{     
      
      font-size: 1.2rem;
      ;
    }
      .editor-panel {
        width: 350px;
      }

     .curriculo-container {
    transform: scale(0.35);
    transform-origin: top center;
      align-items: center;
  }
    }
    
    @media (max-width: 440px) {
      .cee{     
     
      font-size: 1.2rem;
      ;
    }


      .editor-panel {
        width: 348px;
      }

     .curriculo-container {
    transform: scale(0.47);
   transform-origin: top center;
     align-items: center;
  }
    }
    @media (max-width: 398px) {
     
.cee{     
     
      font-size: 1.2rem;
      ;
    }

      .editor-panel {
        width: 360px;
      }

     .curriculo-container {
    transform: scale(0.43);
   transform-origin: top center;
     align-items: center;
  }
  .botoes {
      margin: 2px;
      
    }
    }
    @media (max-width: 374px) {
      
.cee{     
     
      font-size: 1.2rem;
      ;
    }

      .editor-panel {
        width: 300px;
      }

     .curriculo-container {
    transform: scale(0.4);
    transform-origin: top center;
    align-items: center;
  }
  .botoes {
      margin: 2px;
      
    }
    }
/*novo*/
/* Idiomas em duas colunas quando houver vários */

/* --- Estilos para o campo de foto (editor) --- */
/* O elemento vem oculto por padrão (JS faz: campoFoto.style.display = "block") */
#campoFoto {
  display: none;              /* controlado pelo seu JS */
  margin-top: 12px;
  padding: 10px;
  border-radius: 8px;
  border: 1px dashed #e6eefc;
  background: #fbfdff;
  font-size: 0.95rem;
  line-height: 1;
}

/* Label + input alinhados quando o campo é mostrado */
#campoFoto label {
  display: inline-block;
  font-weight: 600;
  color: #0f172a;
  margin-right: 8px;
  vertical-align: middle;
}

#campoFoto input[type="file"] {
  display: inline-block;
  vertical-align: middle;
}

/* Botão do file input (navegadores modernos) */
#campoFoto input[type="file"]::file-selector-button {
  padding: 8px 12px;
  border: none;
  border-radius: 6px;
  background: #1e3a8a;
  color: #fff;
  cursor: pointer;
  font-weight: 600;
}
#campoFoto input[type="file"]::file-selector-button:hover {
  background: #374bb3;
}

/* Miniatura (opcional): adicione <img id="fotoPreview" alt="Pré-visualização"> dentro de #campoFoto se quiser preview */
#fotoPreview {
  display: inline-block;      /* JS pode togglar para 'block'/'inline-block' quando carregar imagem */
  width: 72px;
  height: 72px;
  object-fit: cover;
  border-radius: 6px;
  margin-left: 12px;
  vertical-align: middle;
  border: 1px solid #e2e8f0;
  box-shadow: 0 1px 6px rgba(2,6,23,0.06);
}

/* Texto de ajuda pequeno (opcional) */
#campoFoto .help {
  display: inline-block;
  margin-left: 12px;
  color: #6b7280;
  font-size: 0.85rem;
  vertical-align: middle;
}

/* Responsivo: empilha itens em telas pequenas */
@media (max-width: 480px) {
  #campoFoto { padding: 8px; }
  #fotoPreview { width: 56px; height: 56px; margin-left: 8px; }
  #campoFoto label,
  #campoFoto input[type="file"],
  #campoFoto .help { display: block; margin: 6px 0 0 0;  }
}

   
.idiomas-group {
  display: flex;
  gap: 10px;
  margin-top: 10px;
  margin-bottom: 10px;
  flex-wrap: wrap;
}

.idiomas-group select,
.idiomas-group button {
  flex: 1;
  padding: 6px;
  border-radius: 4px;
  border: 1px solid #ccc;
  font-size: 0.9rem;
}

#listaIdiomas {
  margin-top: 8px;
  padding-left: 16px;
  list-style: disc;
  color: #1e40af;
}
.campo-idiomas {
  margin-bottom: 15px;
}

.campo-idiomas label {
  font-weight: 600;
  margin-bottom: 5px;
  display: block;
}

.campo-idiomas select {
  padding: 6px 10px;
  margin-right: 8px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 14px;
}

.campo-idiomas button {
  padding: 6px 12px;
  background: #007bff;
  border: none;
  border-radius: 6px;
  color: #fff;
  font-size: 14px;
  cursor: pointer;
}

.campo-idiomas button:hover {
  background: #0056b3;
}

[data-id="idiomas"] {
  list-style-type: disc;
  margin-top: 8px;
  margin-left: 20px;
}



  </style>
</head>


<body>
 <header>Editor de Currículo</header>
 <div class="wrapper">
  
 
    <!-- novo -->
    <div class="editor-panel">
      <h2 class="cee">Preencha com os seus dados</h2>
      <div id="campoFoto" style="display:none;">
  <label>Foto:</label>
  <input type="file" id="foto" accept="image/*" />
</div>

      <label>Nome completo:</label>
      <input type="text" id="nome" placeholder="Seu nome" data-input="nome"/>

      <label>Nº do BI:</label>
      <input type="text" id="bi" placeholder="Número do BI" data-input="bi"/>

      <label>Telefone:</label>
      <input type="text" id="telefone" placeholder="Telefone" data-input="telefone"/>


      <label>Data de nascimento:</label>
      <input type="date" id="nascimento" data-input="nascimento"/>

      <label>Localização:</label>
      <input type="text" id="localizacao" placeholder="Endereço" data-input="localizacao"/>

      <label>Objetivo:</label>
      <textarea id="objetivo" placeholder="Escreva seu objetivo" rows="3" data-input="objetivo"></textarea>
      <label>Perfil Profissional(suas Qualidades):</label>
      <textarea id="qualidade" placeholder="Fale sobre Você/Suas Qualidades" rows="3" data-input="qualidade"></textarea>

      <label>Formação Acadêmica:</label>
      <textarea id="formacao" placeholder="Formação acadêmica" rows="3" data-input="formacao"></textarea>

      <label>Experiência Profissional:</label>
      <textarea id="experiencia" placeholder="Experiência Profissional" rows="3" data-input="experiencia"></textarea>

      <label>Curso(s):</label>
<textarea id="curso" placeholder="Liste seus cursos (um por linha)" rows="3" data-input="curso"></textarea>

<label>Idiomas para além do Português:</label>


<div class="idiomas-group">
  <select data-idioma>
    <option value="">Selecione um idioma</option>
    <option value="Inglês">Inglês</option>
    <option value="Francês">Francês</option>
    <option value="Espanhol">Espanhol</option>
  </select>

  <select data-nivel>
    <option value="">Nível</option>
    <option value="Básico">Básico</option>
    <option value="Intermediário">Intermediário</option>
    <option value="Fluente">Fluente</option>
  </select>

  <button type="button" onclick="adicionarIdioma()">Adicionar</button>
</div>

<ul id="listaIdiomas"></ul>



      <label>Habilidades:</label>
      <textarea id="habilidades" placeholder="Habilidades" rows="3" data-input="habilidades"></textarea>
       
      <div class="acoes">
        <button onclick="document.getElementById('curriculoVisual').scrollIntoView({behavior:'smooth'})">Ver Currículo</button>
      </div></div>
    
    

    <!-- Currículo -->
    <!-- ⛔️ Removemos a classe .a4 daqui -->
    <div class="curriculo-container">
        <div class="a4" id="curriculoVisual"></div>
    </div>
  


  <div class="botoes">
    <button onclick="baixarPDF()">Download PDF</button>
    <button onclick="window.location.href='index.html'">Voltar</button>
  </div></div>


 <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
<script>
 const urlParams = new URLSearchParams(window.location.search);
const modelo = urlParams.get("modelo") || "cv1"; // sempre algo tipo "cv1", "cv2"...
console.log("Modelo carregado:", modelo);
 const token = urlParams.get("token");

  // 🔒 Bloqueio de acesso sem token
  if (!token) {
    alert("Acesso negado! Por favor, realize o pagamento primeiro.");
    window.location.href = "pagament.html";
  }



// Carregar o HTML do modelo
fetch(`modelos/${modelo}.html`)
  .then(res => {
    if (!res.ok) throw new Error("Modelo não encontrado: " + modelo);
    return res.text();
  })



  // novo
  .then(html => {
    document.getElementById("curriculoVisual").innerHTML = html;
  // Mostrar campo de upload só se o modelo tiver espaço para foto
  if (document.querySelector('[data-id="foto"]')) {
    document.getElementById("campoFoto").style.display = "block";
  }
})







  .catch(err => {
    console.error(err);
    document.getElementById("curriculoVisual").innerHTML = "<p style='color:red'>Erro ao carregar modelo.</p>";
  });
// novo
document.getElementById("foto")?.addEventListener("change", (e) => {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = (ev) => {
    const imgTarget = curriculoVisual.querySelector('[data-id="foto"]');
    if (imgTarget) imgTarget.src = ev.target.result;
  };
  reader.readAsDataURL(file);
});


      
    function adicionarIdioma() {
  const idiomaEl = document.querySelector("[data-idioma]");
  const nivelEl = document.querySelector("[data-nivel]");
  const idioma = idiomaEl.value;
  const nivel = nivelEl.value;
  const container = document.querySelector('[data-id="idiomas"]');

  if (!idioma || !nivel || !container) return;

  // Mantém o português fixo
  const base = ["Português (Nativo)"];

  // Pega idiomas já adicionados (ignorando o português fixo)
  const extras = [...container.querySelectorAll("li")]
    .map(li => li.textContent)
    .filter(txt => !txt.includes("Português"));

  // Atualiza lista com português + novos idiomas
  extras.push(`${idioma} (${nivel})`);
  container.innerHTML = [...base, ...extras]
    .map(i => `<li>${i}</li>`)
    .join("");

  // 🔹 Limpa os selects para mostrar que dá pra adicionar mais
  idiomaEl.value = "";
  nivelEl.value = "";
  idiomaEl.focus();
}


// Atualização em tempo real para todos os campos de texto
document.querySelectorAll("[data-input]").forEach(input => {
  input.addEventListener("input", () => {
    const targetId = input.getAttribute("data-input");
    const targetEl = document.querySelector(`[data-id="${targetId}"]`);
    if (!targetEl) return;

    // Se o destino for lista (habilidades, experiencia, cursos, idiomas)
    if (targetEl.tagName === "UL") {
      // Quebra por ENTER (não por vírgula)
      const linhas = input.value.split(/\n/).map(v => v.trim()).filter(v => v);
      targetEl.innerHTML = linhas.map(v => `<li>${v}</li>`).join("");
    } 
    else {
      // Campos simples continuam com textContent
      targetEl.textContent = input.value;
    }
  });
});






 function baixarPDF() {
  const a4Element = document.querySelector("#curriculoVisual .a4"); 
  if (!a4Element) return;

  const originalTransform = a4Element.style.transform;
  const originalWidth = a4Element.style.width;

  a4Element.style.transform = "none";
  a4Element.style.width = "794px";

  const opt = {
    margin: 0,
    filename: 'curriculo.pdf',
    image: { type: 'jpeg', quality: 1 },
    html2canvas: { scale: 4, useCORS: true, logging: false, allowTaint: true, scrollY: 0 },
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
  };

  html2pdf().set(opt).from(a4Element).save().then(() => {
    a4Element.style.transform = originalTransform;
    a4Element.style.width = originalWidth;

    // 🔥 Após download, redireciona para a página principal com Upsell
    setTimeout(() => {
      window.location.href = "index.html?upsell=carta";
    }, 2000);
  });
}


</script>

</body>
</html>
